{% extends "base.html" %}

{% block title %}Orders{% endblock %}

{% block body %}

<div class="container">
    <h1>Orders</h1>
    
    <!-- Display last 6 orders -->
    <div class="row">
        {% for order in last_orders %}
            <div class="col-md-4">
                <div class="card mb-3">
                    <div class="card-header">
                        Order #{{ order.order_id }}
                    </div>
                    <div class="card-body">
                        <h5 class="card-title">{{ order.order_name }}</h5>
                        <p class="card-text"><strong>Description:</strong> {{ order.order_description }}</p>
                        <p class="card-text"><strong>Department:</strong> {{ order.department_name }}</p>
                        <p class="card-text">
                            <strong>State:</strong>
                            <span class="badge {{ 'badge-success' if order.order_state == 'in progress' else 'badge-danger' if order.order_state == 'waiting' else 'badge-secondary' }}">
                                {{ order.order_state }}
                            </span>
                        </p>
                        <form action="{{ url_for('change_order_state', order_id=order.order_id) }}" method="post" class="form-inline">
                            <select name="new_state" class="form-control mr-2">
                                <option value="in progress" {% if order.order_state == 'in progress' %}selected{% endif %}>In Progress</option>
                                <option value="waiting" {% if order.order_state == 'waiting' %}selected{% endif %}>Waiting</option>
                                <option value="completed" {% if order.order_state == 'completed' %}selected{% endif %}>Completed</option>
                            </select>
                            <button type="submit" class="btn btn-secondary">Change State</button>
                        </form>
                        <br>
                        <a href="{{ url_for('edit_order', order_id=order.order_id) }}" class="btn btn-primary">Edit</a>
                        <form action="{{ url_for('delete_order', order_id=order.order_id) }}" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-danger">Delete</button>
                        </form>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <!-- Button to navigate to add_order page -->
    <div class="text-center mb-4">
        <a href="{{ url_for('add_order') }}" class="btn btn-primary btn-lg">Add Order</a>
    </div>
    
</div>

{% endblock %}
